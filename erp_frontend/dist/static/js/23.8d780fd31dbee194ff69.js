webpackJsonp([23],{"1cfq":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("bOdI"),a=n.n(o),r=(n("wtDQ"),n("UM7R"),n("UgCr")),i=n("FWz8");function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Date,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"";this.product_number=t,this.product_img=e,this.product_name=n,this.product_amount=o,this.remain_amount=a,this.order_id=r,this.buy_date=i,this.remark=l}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.product_number=t,this.product_name=e}var s,d={product_number:[{required:!0,message:"请填写产品编号",trigger:"blur"}],product_amount:[{required:!0,message:"请填写产品数量",trigger:"blur"}]},u=n("2uFj"),m=n("TvqX"),p={name:"order_products",data:function(){return{searchForm:new c,form:new l,rules:d,searchModel:c,model:l,tools:m.a,showMenu:!1,searchSelect:"order_number",searchContent:"",types:["无"],templateFile:u.a.site+"/xls/config.xlsx",goods:[],getIndex:null,currentRecord:null,routeId:null,tableData:[],editDialogFormVisible:!1,uploadId:"",teachers:[],loading:!1,isNew:!1,isEdit:!1,current_page:1,total:0,pageSize:10,order_number:null,merchant_name:"",merchant_number:""}},filters:{filterOrderTime:function(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},filterStatus:function(t){return["","未发","已发未完","已发完"][t]}},computed:{summary:function(){return this.order_number?"订单编号： <span>"+this.order_number+" </span>,  商家编号: <span>"+this.merchant_number+" </span>,  商家名称： <span>"+this.merchant_name+" </span>":""}},created:function(){var t=this;this.routeId=parseInt(this.$route.params.id),Object(i.getInfoById)(this.routeId).then(function(e){var n=e.data,o=n.order_number,a=n.merchant_name,r=n.merchant_number;t.order_number=o,t.merchant_name=a,t.merchant_number=r}),this.fetchData()},methods:(s={editProduct:function(){this.edit({id:this.currentRecord})},amoutChange:function(t){this.form.remain_amount=t},showPackage:function(){this.currentRecord=this.$route.params.id,this.$router.push({path:"/order/"+this.currentRecord+"/package"})},showContent:function(){this.$router.push({path:"/order/index"})},deleteHandle:function(){this.del({id:this.currentRecord},"删除该产品，将同时删除该产品对应的包裹信息，是否继续")},find:function(t){var e=this;this.$nextTick().then(function(){e.fetchData()})},dblHandle:function(t,e,n){this.edit({id:t.id})},rowHandle:function(t,e,n){this.getIndex=t.index},contextHandle:function(t,e,n){this.getIndex=t.index,this.currentRecord=t.id},tableRowClassName:function(t){var e=t.row,n=t.rowIndex;e.index=n},selectedHighlight:function(t){t.row;var e=t.rowIndex;if(this.getIndex===e)return{"background-color":"#CAE1ff"}}},a()(s,"find",function(){this.fetchData()}),a()(s,"findReset",function(){var t=this.searchModel;this.searchForm=new t,this.fetchData()}),a()(s,"fetchData",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchForm,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.current_page,n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pageSize;arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.currentRecord;this.loading=!0,Object(r.getInfo)(t,e,o,this.routeId).then(function(t){if("function"==typeof n.listHandle)n.listHandle(t);else{var e=t.data;n.tableData=e}n.total=t.meta.total,n.loading=!1}).catch(function(t){n.tools.error(n,t.response.data),n.loading=!1})}),a()(s,"add",function(){var t=this.model;this.form=new t,this.editDialogFormVisible=!0,this.isNew=!0}),a()(s,"save",function(){var t=this;this.$refs.ruleForm.validate(function(e){if(!e)return!1;t.editDialogFormVisible=!1,t.isNew&&(t.isNew=!1,t.newData()),t.isEdit&&(t.isEdit=!1,t.updateData())})}),a()(s,"cancel",function(){this.editDialogFormVisible=!1,this.isNew=!1,this.isEdit=!1}),a()(s,"edit",function(t){var e=this,n=t.id;this.uploadId=n,Object(r.getInfoById)(n).then(function(t){if("function"==typeof e.editHandle)e.editHandle(t);else{var n=t.data;e.form=n}e.isEdit=!0,e.editDialogFormVisible=!0})}),a()(s,"updateData",function(){var t=this;Object(r.updateInfo)(this.uploadId,this.form).then(function(e){200==e.status_code&&(t.fetchData(),t.tools.success(t,"信息更新成功"))}).catch(function(e){t.tools.error(t,e.response.data)})}),a()(s,"newData",function(){var t=this;this.form.order_id=this.routeId,Object(r.addInfo)(this.form).then(function(e){t.tools.success(t,"功能信息添加成功"),t.fetchData()}).catch(function(e){t.tools.error(t,e.response.data)})}),a()(s,"del",function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"删除该产品，将同时删除该产品对应的包裹信息，是否继续";this.$confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n=t.id;Object(r.deleteInfoById)(n).then(function(t){200==t.status_code&&(e.$message({type:"success",message:"删除成功!"}),e.fetchData())}).catch(function(t){e.tools.error(e,t.response.data)})})}),a()(s,"selectChange",function(t){this.multiSelect=t}),a()(s,"delAll",function(){var t=this;this.$confirm("此操作将永久删除该功能, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=[];t.multiSelect.forEach(function(t){e.push(t.id)}),Object(r.deleteAll)(e).then(function(e){t.fetchData()}).catch(function(e){t.tools.error(e.response.data)})}).catch(function(){t.tools.errorTips(t,"删除操作已经取消")})}),a()(s,"pagination",function(t){this.current_page=t,this.fetchData()}),a()(s,"sizeChange",function(t){this.pageSize=t,this.fetchData()}),s)},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"config"}},[n("el-form",{staticClass:"demo-form-inline",attrs:{id:"toolbar",inline:!0,model:t.searchForm}},[n("el-form-item",[n("el-input",{attrs:{placeholder:"请输入产品编号"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.find(e)}},model:{value:t.searchForm.product_number,callback:function(e){t.$set(t.searchForm,"product_number",e)},expression:"searchForm.product_number"}})],1),t._v(" "),n("el-form-item",[n("el-input",{attrs:{type:"text",placeholder:"请输入产品名称"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.find(e)}},model:{value:t.searchForm.merchant_name,callback:function(e){t.$set(t.searchForm,"merchant_name",e)},expression:"searchForm.merchant_name"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{plain:""},on:{click:function(e){t.find()}}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{type:"info",plain:""},on:{click:function(e){t.findReset()}}},[t._v("重置")])],1)],1),t._v(" "),n("div",{attrs:{id:"datagrid"}},[n("div",{staticClass:"toolbar"},[n("el-row",[n("el-col",{attrs:{span:6}},[n("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(e){t.add()}}},[t._v("添加产品信息")])],1),t._v(" "),n("el-col",{attrs:{span:18}},[n("p",{staticClass:"tips",domProps:{innerHTML:t._s(t.summary)}})])],1)],1),t._v(" "),n("el-table",{directives:[{name:"contextmenu",rawName:"v-contextmenu:contextmenu",arg:"contextmenu"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{size:"mini",data:t.tableData,"row-class-name":t.tableRowClassName,"row-style":t.selectedHighlight,border:""},on:{"row-contextmenu":t.contextHandle,"row-dblclick":t.dblHandle,"row-click":t.rowHandle,"select-all":t.selectChange,"selection-change":t.selectChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{label:"产品编号",prop:"product_number",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{label:"产品名称",prop:"product_name",width:"150"}}),t._v(" "),n("el-table-column",{attrs:{label:"产品图片",width:"100"},scopedSlots:t._u([{key:"default",fn:function(t){return[n("img",{staticStyle:{display:"block",width:"80px",height:"80px"},attrs:{src:t.row.product_img}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"购买数量",prop:"product_amount",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"未发货数量",prop:"remain_amount",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"购买日期",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t._f("filterOrderTime")(e.row.buy_date)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"备注",prop:"remark",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{content:"编辑",placement:"right-end",effect:"light"}},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"cates.show",expression:"'cates.show'"}],attrs:{plain:"",icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(n){t.edit(e.row)}}})],1),t._v(" "),n("el-tooltip",{attrs:{content:"删除",placement:"right-end",effect:"light"}},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"cates.destory",expression:"'cates.destory'"}],attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(n){t.del(e.row)}}})],1)]}}])})],1),t._v(" "),n("el-row",{staticClass:"page"},[n("el-col",{attrs:{span:2,offset:1}}),t._v(" "),n("el-col",{attrs:{span:20}},[n("el-pagination",{attrs:{background:"","current-page":t.current_page,"page-sizes":[10,20,25,50],layout:"total,sizes,prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.pagination,"size-change":t.sizeChange,"update:currentPage":function(e){t.current_page=e},"update:pageSize":function(e){t.pageSize=e}}})],1)],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"产品管理",center:"",visible:t.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogFormVisible=e}}},[n("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"产品编号",prop:"product_number"}},[n("el-input",{attrs:{disabled:!0===this.isEdit,placeholder:"请输入产品编号"},model:{value:t.form.product_number,callback:function(e){t.$set(t.form,"product_number",e)},expression:"form.product_number"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"产品名称",prop:"product_name"}},[n("el-input",{attrs:{placeholder:"请输入产品名称"},model:{value:t.form.product_name,callback:function(e){t.$set(t.form,"product_name",e)},expression:"form.product_name"}})],1)],1)],1),t._v(" "),!0===this.isNew?n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"购买数量"}},[n("el-input-number",{attrs:{min:1,label:"请输入购买数量"},on:{change:t.amoutChange},model:{value:t.form.product_amount,callback:function(e){t.$set(t.form,"product_amount",e)},expression:"form.product_amount"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"待分割数量"}},[n("el-input-number",{attrs:{disabled:"",min:1},model:{value:t.form.remain_amount,callback:function(e){t.$set(t.form,"remain_amount",e)},expression:"form.remain_amount"}})],1)],1)],1):t._e(),t._v(" "),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"购买日期",prop:"buy_date"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"购买日期"},model:{value:t.form.buy_date,callback:function(e){t.$set(t.form,"buy_date",e)},expression:"form.buy_date"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"产品图像",prop:"product_img"}},[n("el-input",{attrs:{placeholder:"请输入产品图像对应的地址"},model:{value:t.form.product_img,callback:function(e){t.$set(t.form,"product_img",e)},expression:"form.product_img"}})],1)],1)],1),t._v(" "),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"备注",prop:"remark"}},[n("el-input",{attrs:{placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",[t.form.product_img?n("img",{staticStyle:{width:"150px",height:"150px"},attrs:{src:t.form.product_img}}):t._e()])],1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.save()}}},[t._v("确 定")]),t._v(" "),n("el-button",{on:{click:function(e){t.cancel()}}},[t._v("取 消")])],1)],1),t._v(" "),n("v-contextmenu",{ref:"contextmenu"},[n("v-contextmenu-item",{on:{click:t.add}},[t._v("新增产品")]),t._v(" "),n("v-contextmenu-item",{attrs:{divider:!0}}),t._v(" "),n("v-contextmenu-item",{on:{click:t.editProduct}},[t._v("修改产品")]),t._v(" "),n("v-contextmenu-item",{on:{click:t.deleteHandle}},[t._v("删除产品")]),t._v(" "),n("v-contextmenu-item",{attrs:{divider:!0}}),t._v(" "),n("v-contextmenu-item",{on:{click:t.showPackage}},[t._v("分割包裹")]),t._v(" "),n("v-contextmenu-item",{attrs:{divider:!0}}),t._v(" "),n("v-contextmenu-item",{on:{click:t.showContent}},[t._v("返回订单")])],1)],1)},staticRenderFns:[]};var h=n("VU/8")(p,f,!1,function(t){n("W3wJ")},null,null);e.default=h.exports},"9bBU":function(t,e,n){n("mClu");var o=n("FeBl").Object;t.exports=function(t,e,n){return o.defineProperty(t,e,n)}},C4MV:function(t,e,n){t.exports={default:n("9bBU"),__esModule:!0}},UgCr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getInfo=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=arguments[3];return Object(r.a)({url:i.product_baseUrl,method:"get",params:{id:n,page:t,pageSize:e}})},e.getInfoById=function(t){return Object(r.a)({url:i.product_baseUrl+"/"+t,method:"get"})},e.updateInfo=function(t,e){"string"==typeof e.buy_date?e.buy_date=Math.ceil(Date.parse(e.buy_date)/1e3):e.buy_date=Math.ceil(e.buy_date.getTime()/1e3);return Object(r.a)({url:i.product_baseUrl+"/"+t,method:"PATCH",data:e})},e.deleteInfoById=function(t){return Object(r.a)({url:i.product_baseUrl+"/"+t,method:"delete"})},e.addInfo=function(t){return console.log(a()(t.buy_date)),t.buy_date=Math.ceil(t.buy_date.getTime()/1e3),Object(r.a)({url:i.product_baseUrl,method:"post",data:t})},e.deleteAll=function(t){return Object(r.a)({url:i.product_baseUrl+"/deleteAll",method:"post",data:{ids:t}})};var o=n("pFYg"),a=n.n(o),r=n("Vo7i"),i=n("P9l9")},Vj1e:function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n#toolbar {\n  background-color: #e8e8e8 !important;\n  margin-bottom: 5px;\n}\n#toolbar .el-form-item {\n    margin-bottom: 5px;\n    margin-top: 5px;\n    margin-left: 5px;\n}\n#datagrid {\n  border: 1px solid #ddd;\n  padding-bottom: 5px;\n}\n#datagrid .toolbar {\n    padding-left: 5px;\n    margin-bottom: 5px;\n    margin-top: 5px;\n}\n#datagrid .page {\n    margin-top: 5px;\n    height: 40px;\n}\n#datagrid .page .el-col-2 {\n      text-align: center;\n      min-width: 120px;\n      height: 100%;\n}\n#datagrid .page .el-col-20 {\n      line-height: 40px;\n      height: 100%;\n}\n#datagrid .page .el-col-20 .el-pagination {\n        padding: 0;\n        margin-top: 5px;\n        text-align: center;\n}\n#config .el-input {\n  width: 100%;\n  margin-left: 10px;\n}\n#config .el-input-number {\n  width: 90%;\n  margin-left: 10px;\n}\n#datagrid .toolbar {\n  margin-bottom: 10px;\n}\n#datagrid .toolbar .tips {\n    line-height: 40px;\n    height: 40px;\n    margin: 0px;\n    padding: 0px 10px;\n}\n#datagrid .toolbar .tips span {\n      color: #f44;\n}\n#datagrid .page {\n  margin-top: 10px;\n}\n.el-button--mini.is-round,\n.toolbar-config .el-button--mini {\n  padding: 10px;\n}\n.toolbar-config .el-button + .el-button {\n  margin-left: 5px;\n}\n",""])},W3wJ:function(t,e,n){var o=n("Vj1e");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("c1204fbe",o,!0)},bOdI:function(t,e,n){"use strict";e.__esModule=!0;var o,a=n("C4MV"),r=(o=a,o&&o.__esModule?o:{default:o});e.default=function(t,e,n){return e in t?(0,r.default)(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},mClu:function(t,e,n){var o=n("kM2E");o(o.S+o.F*!n("+E39"),"Object",{defineProperty:n("evD5").f})}});