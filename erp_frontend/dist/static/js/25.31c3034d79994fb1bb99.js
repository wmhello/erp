webpackJsonp([25,10,20,41],{"5eyz":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getInfo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(o.a)({url:"/api/admin",method:"get",params:{page:e,pageSize:a,name:t.name,email:t.email}})},e.getCurrentPage=function(t){return Object(o.a)({url:"/api/admin",method:"get",params:{page:t}})},e.getInfoById=function(t){return Object(o.a)({url:"/api/admin/"+t,method:"get"})},e.resetAdminByPsw=function(t,e){return Object(o.a)({url:"/api/admin/"+t+"/reset",method:"post",data:{password:e}})},e.uploadAdminByImg=function(t){return Object(o.a)({url:"/api/admin/uploadAvatar",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})},e.updateInfo=function(t,e){return Object(o.a)({url:"/api/admin/"+t,method:"put",params:{name:e.name,role:e.role,avatar:e.avatar},headers:{"Content-Type":"application/x-www-form-urlencoded"}})},e.deleteInfoById=function(t){return Object(o.a)({url:"/api/admin/"+t,method:"delete"})},e.addInfo=function(t){return console.log(t),Object(o.a)({url:"/api/admin",method:"post",data:t})},e.uploadFile=function(t){return Object(o.a)({url:"/api/admin/upload",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})},e.exportCurrentPage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(o.a)({url:"/api/admin/export",method:"post",data:{page:e,pageSize:t,name:a.name,email:a.email}})},e.exportAll=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o.a)({url:"/api/admin/exportAll",method:"post",data:{name:t.name,email:t.email}})},e.deleteAll=function(t){return Object(o.a)({url:"/api/admin/deleteAll",method:"post",data:{ids:t}})},e.Model=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this.name=t,this.email=e,this.role=a,this.avatar=o,this.password=n,this.password_confirmation=i},e.SearchModel=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";this.name=t,this.email=e};var o=a("Vo7i")},STSY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getInfo=function(){return Object(o.a)({url:"/api/role",method:"get"})},e.getRoles=function(){return Object(o.a)({url:"/api/getRoles",method:"get"})},e.getInfoById=function(t){return Object(o.a)({url:"/api/role/"+t,method:"get"})},e.updateInfo=function(t,e){return Object(o.a)({url:"/api/role/"+t,method:"PATCH",data:e})},e.deleteInfoById=function(t){return Object(o.a)({url:"/api/role/"+t,method:"delete"})},e.addInfo=function(t){return Object(o.a)({url:"/api/role",method:"post",data:t})},e.Model=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.name=t,this.explain=e,this.remark=a,this.permission=o};var o=a("Vo7i")},XuNu:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"",""])},fam1:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("TvqX"),n={name:"DownloadXls",props:{show:Boolean,templateFile:String,module:String,pageSize:Number,page:Number,search:Object},data:function(){return{}},computed:{exportDialogFormVisible:function(){return this.show}},methods:{cancelDownload:function(){this.$emit("close-download")},exportData:function(t){var e=this;switch(t){case 1:a("2HpL")("./"+this.module).then(function(t){(0,t.exportCurrentPage)(e.pageSize,e.page,e.search).then(function(t){location.href=e.templateFile}).catch(function(t){o.a.error(e,t.response.data)})});break;case 2:a("2HpL")("./"+this.module).then(function(t){(0,t.exportAll)(e.search).then(function(t){location.href=e.templateFile}).catch(function(t){o.a.error(e,t.response.data)})})}}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"数据导出",visible:t.exportDialogFormVisible,"close-on-click-modal":!1},on:{close:function(e){t.cancelDownload()}}},[a("div",[a("p",[t._v("请选择导出的数据范围")])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.exportData(1)}}},[t._v("当前页")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.exportData(2)}}},[t._v("全部")])],1)])},staticRenderFns:[]};var l=a("VU/8")(n,i,!1,function(t){a("imsJ")},"data-v-1266772c",null);e.default=l.exports},iYVw:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("TIfe");var o=a("5eyz"),n=a("STSY"),i=a("2uFj"),l=a("YC21"),r=a("fam1"),s=a("TvqX"),c={components:{UploadXls:l.default,DownloadXls:r.default},data:function(){return{searchForm:new o.SearchModel,form:new o.Model,imageUrl:"",tableData:[],resetDialogFormVisible:!1,editDialogFormVisible:!1,templateFile:i.a.site+"/xls/user.xls",downloadFile:i.a.site+"/xls/用户管理.xls",resetId:"",uploadId:"",isNew:!1,isEdit:!1,isShowUpload:!1,isShowDownload:!1,form2:{psw:"",newpsw:""},roles:[],loading:!1,current_page:1,total:0,pageSize:10,multiSelect:[]}},methods:{find:function(){this.fetchData()},findReset:function(){this.searchForm=new o.SearchModel,this.fetchData()},add:function(){this.isNew=!0,this.form=new o.Model,this.editDialogFormVisible=!0},upload:function(){this.isShowUpload=!0},closeUpload:function(){this.isShowUpload=!1},download:function(){this.isShowDownload=!0},closeDownload:function(){this.isShowDownload=!1},beforeUpload:function(t){var e=this,a=new FormData;return a.append("photo",t),Object(o.uploadAdminByImg)(a).then(function(t){var a=t.data.url;e.form.avatar=a,e.imageUrl=i.a.site+"/"+a}),!0},fetchData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchForm,e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.current_page,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pageSize;this.loading=!0,Object(o.getInfo)(t,a,n).then(function(t){var a=t.data;e.tableData=a,e.total=t.meta.total,e.loading=!1}).catch(function(){e.loading=!1})},edit:function(t){var e=this,a=t.id;this.uploadId=a,Object(o.getInfoById)(a).then(function(t){var a=t.data;e.form=a,a.avatar?e.imageUrl=i.a.site+"/"+a.avatar:e.imageUrl="",e.isEdit=!0,e.editDialogFormVisible=!0})},cancel:function(){this.isNew=!1,this.isEdit=!1,this.editDialogFormVisible=!1},save:function(){this.editDialogFormVisible=!1,this.isNew&&(this.isNew=!1,this.newData()),this.isEdit&&(this.isEdit=!1,this.updateData())},newData:function(){var t=this;Object(o.addInfo)(this.form).then(function(e){s.a.success(t,"用户添加成功"),t.fetchData()}).catch(function(e){s.a.error(t,e.response.data)})},updateData:function(){var t=this;Object(o.updateInfo)(this.uploadId,this.form).then(function(e){if(200==e.status_code){var a=t.form.id,o=0;o=t.tableData.findIndex(function(t,e){return t.id==a}),t.tableData.splice(o,1,t.form),t.editDialogFormVisible=!1,s.a.success(t,"用户信息修改成功")}}).catch(function(e){s.a.error(t,e.response.data)})},reset:function(t){this.form2={psw:"",newpsw:""},this.resetDialogFormVisible=!0,this.resetId=t.id},cancelPassword:function(){this.resetDialogFormVisible=!1},savePassword:function(){var t=this;if(this.form2.psw==this.form2.newpsw&&this.form2.psw){var e=this.form2.psw;Object(o.resetAdminByPsw)(this.resetId,e).then(function(e){200==e.status_code&&(e.message?s.a.success(t,e.message):s.a.success(t,"删除成功!"),t.resetDialogFormVisible=!1)})}else s.a.errorTips(this,"输入密码为空或两次输入密码不同，请重新输入！"),this.resetDialogFormVisible=!1},del:function(t){var e=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a=t.id,n=null;n=e.tableData.findIndex(function(t){return t.id==a}),Object(o.deleteInfoById)(a).then(function(t){200==t.status_code&&(t.message?s.a.success(e,t.message):(s.a.success(e,"删除成功!"),e.tableData.splice(n,1)))}).catch(function(){})}).catch(function(){})},selectChange:function(t){this.multiSelect=t},delAll:function(){var t=this;this.$confirm("此操作将永久删除用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=[];t.multiSelect.forEach(function(t){e.push(t.id)}),Object(o.deleteAll)(e).then(function(e){200==e.status_code&&(e.message?s.a.success(t,e.message):(s.a.success(t,"删除成功!"),t.fetchData()))}).catch(function(t){s.a.error(t.response.data)})}).catch(function(){s.a.errorTips(t,"删除操作已经取消")})},pagination:function(t){this.current_page=t,this.fetchData()},sizeChange:function(t){this.pageSize=t,this.fetchData()},getRoleAll:function(){this.roles=[{name:"admin",explain:"管理员"}]}},mounted:function(){},beforeCreate:function(){var t=this;Object(n.getRoles)().then(function(e){t.roles=[{name:"admin",explain:"管理员"}],t.fetchData()}).catch(function(t){})},filters:{roleFilter:function(t,e){return e.find(function(e){return e.name==t}).explain},avatarFilter:function(t){return i.a.site+"/"+t}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"admin"}},[a("div",{attrs:{id:"datagrid"}},[a("div",{staticClass:"toolbar"},[a("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(e){t.add()}}},[t._v("添加")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0},on:{"select-all":t.selectChange,"selection-change":t.selectChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"id",label:"序号",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"email",label:"登录名"}}),t._v(" "),a("el-table-column",{staticClass:"box",attrs:{label:"角色"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.role,function(e){return a("el-tag",{key:e,staticStyle:{"margin-right":"5px"},attrs:{size:"medium"}},[t._v(t._s(t._f("roleFilter")(e,t.roles)))])})}}])}),t._v(" "),a("el-table-column",{attrs:{label:"头像",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.avatar?a("img",{attrs:{src:t._f("avatarFilter")(e.row.avatar),alt:"",width:"50",height:"50"}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",["admin"!==e.row.email?a("el-tooltip",{attrs:{content:"编辑",placement:"right-end"}},[a("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-edit-outline"},on:{click:function(a){t.edit(e.row)}}})],1):t._e(),t._v(" "),"admin"!==e.row.email?a("el-tooltip",{attrs:{content:"修改密码",placement:"right-end"}},[a("el-button",{attrs:{plain:"",icon:"el-icon-setting",size:"small"},on:{click:function(a){t.reset(e.row)}}})],1):t._e()],1)]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"用户信息",visible:t.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogFormVisible=e},close:function(e){return t.cancel(),!0}}},[a("el-form",{attrs:{model:t.form,"label-width":"80px","label-position":"top"}},[a("el-row",{staticClass:"first-row"},[a("el-col",{staticClass:"first-column",attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"登录名"}},[a("el-input",{attrs:{disabled:t.isEdit},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1)],1),t._v(" "),t.isNew?a("el-row",{staticClass:"normal-row"},[a("el-col",{staticClass:"first-column",attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[a("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1)],1)],1):t._e(),t._v(" "),a("el-row",{staticClass:"last-row",staticStyle:{height:"290px",overflow:"hidden"}},[a("el-col",{staticClass:"first-column",staticStyle:{height:"100%"},attrs:{span:10,offset:2}},[a("el-form-item",{attrs:{label:"用户头像"}},[a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{drag:"",action:"123",accept:".jpg,.png","before-upload":t.beforeUpload}},[t.form.avatar?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("上传头像，只能传jpg/png文件")])])],1)],1),t._v(" "),a("el-col",{staticStyle:{height:"100%"},attrs:{span:10}},[a("el-form-item",{attrs:{label:"用户角色"}},[a("el-select",{attrs:{multiple:"",placeholder:"用户权限"},model:{value:t.form.role,callback:function(e){t.$set(t.form,"role",e)},expression:"form.role"}},t._l(t.roles,function(e){return a("el-option",{key:e.name,attrs:{label:e.explain,value:e.name}},[t._v("\n               "+t._s(e.explain))])}))],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cancel()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.save()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"密码重置",visible:t.resetDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.resetDialogFormVisible=e}}},[a("el-form",{attrs:{model:t.form2,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"请输入新密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form2.psw,callback:function(e){t.$set(t.form2,"psw",e)},expression:"form2.psw"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"再次确认密码"}},[a("el-input",{attrs:{type:"password"},model:{value:t.form2.newpsw,callback:function(e){t.$set(t.form2,"newpsw",e)},expression:"form2.newpsw"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.cancelPassword()}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.savePassword()}}},[t._v("确 定")])],1)],1),t._v(" "),a("el-row",{staticClass:"page"},[a("el-col",{attrs:{span:2,offset:1}}),t._v(" "),a("el-col",{attrs:{span:20}},[a("el-pagination",{attrs:{background:"","current-page":t.current_page,"page-sizes":[10,20,25,50],layout:"total,sizes,prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.pagination,"size-change":t.sizeChange,"update:currentPage":function(e){t.current_page=e},"update:pageSize":function(e){t.pageSize=e}}})],1)],1)],1),t._v(" "),a("upload-xls",{attrs:{show:t.isShowUpload,"template-file":t.templateFile,module:"admin"},on:{"close-upload":t.closeUpload}}),t._v(" "),a("download-xls",{attrs:{show:t.isShowDownload,"template-file":t.downloadFile,module:"admin",pageSize:t.pageSize,page:t.current_page,search:t.searchForm},on:{"close-download":t.closeDownload}})],1)},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(t){a("pa3e")},null,null);e.default=u.exports},imsJ:function(t,e,a){var o=a("XuNu");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("431b20e4",o,!0)},lyKs:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n#toolbar {\n  background-color: #e8e8e8 !important;\n  margin-bottom: 5px;\n}\n#toolbar .el-form-item {\n    margin-bottom: 5px;\n    margin-top: 5px;\n    margin-left: 5px;\n}\n#datagrid {\n  border: 1px solid #ddd;\n  padding-bottom: 5px;\n}\n#datagrid .toolbar {\n    padding-left: 5px;\n    margin-bottom: 5px;\n    margin-top: 5px;\n}\n#datagrid .page {\n    margin-top: 5px;\n    height: 40px;\n}\n#datagrid .page .el-col-2 {\n      text-align: center;\n      min-width: 120px;\n      height: 100%;\n}\n#datagrid .page .el-col-20 {\n      line-height: 40px;\n      height: 100%;\n}\n#datagrid .page .el-col-20 .el-pagination {\n        padding: 0;\n        margin-top: 5px;\n        text-align: center;\n}\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #20a0ff;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n.avatar {\n  width: 178px;\n  height: 178px;\n  display: block;\n}\n#admin .el-form--label-top .el-form-item__label {\n  width: 100%;\n  text-align: center;\n}\n#admin .el-form-item__content {\n  text-align: center;\n}\n#admin .el-col-10 > .el-form-item > .el-form-item__content > .el-input {\n  width: 80%;\n}\n#admin .first-row .el-col {\n  border: 1px solid black;\n  border-left: 0px;\n}\n#admin .first-row .first-column {\n  border-left: 1px solid black;\n}\n#admin .normal-row .el-col {\n  border: 1px solid black;\n  border-left: 0px;\n  border-top: 0px;\n}\n#admin .normal-row .first-column {\n  border-left: 1px solid black;\n}\n#admin .last-row .el-col {\n  border: 1px solid black;\n  border-top: 0px;\n  border-left: 0px;\n}\n#admin .last-row .first-column {\n  border-left: 1px solid black;\n}\n#admin .last-row .first-column .el-upload-dragger {\n  width: auto;\n  height: auto;\n}\n",""])},pa3e:function(t,e,a){var o=a("lyKs");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("50f7b618",o,!0)}});