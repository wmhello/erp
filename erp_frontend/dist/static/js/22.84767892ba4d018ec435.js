webpackJsonp([22],{"5PlU":function(t,e,n){var o=n("RY/4"),r=n("dSzd")("iterator"),i=n("/bQp");t.exports=n("FeBl").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||i.hasOwnProperty(o(e))}},BO1k:function(t,e,n){t.exports={default:n("fxRn"),__esModule:!0}},T452:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getInfo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(i.a)({url:"/api/configs",method:"get",params:{page:e,pageSize:n,sub_number:t.sub_number}})},e.getInfoById=function(t){return Object(i.a)({url:"/api/configs/"+t,method:"get"})},e.updateInfo=function(t,e){return Object(i.a)({url:"/api/configs/"+t,method:"PATCH",data:{id:t,sub_number:e.sub_number,result:r()(e.result),remark:e.remark}})},e.deleteInfoById=function(t){return Object(i.a)({url:"/api/configs/"+t,method:"delete"})},e.addInfo=function(t){return Object(i.a)({url:"/api/configs",method:"post",data:{sub_number:t.sub_number,result:r()(t.result),remark:t.remark}})},e.deleteAll=function(t){return Object(i.a)({url:"/api/configs/deleteAll",method:"post",data:{ids:t}})},e.uploadFile=function(t){return Object(i.a)({url:"/api/configs/upload",method:"post",data:t,headers:{"Content-Type":"multipart/form-data"}})},e.getConfigsInfo=function(){return Object(i.a)({url:"/api/configs/getAll",method:"get"})};var o=n("mvHQ"),r=n.n(o),i=n("Vo7i")},Xd32:function(t,e,n){n("+tPU"),n("zQR9"),t.exports=n("5PlU")},YLmy:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("d7EF"),r=n.n(o),i=n("wtDQ"),a=n("UM7R"),l=n("T452"),s=n("1x0Q");function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:"");this.sub_number=t,this.result=[],this.remark=e}function c(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;this.id=null,this.number=t,this.name=e,this.count=n,this.status=o}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.sub_number=t,this.good_number=e}var m={sub_number:[{required:!0,message:"请填写配对编号",trigger:"blur"}]},f=n("2uFj"),p=n("TvqX"),g={name:"Config",components:{UploadXls:n("YC21").default},mixins:[i.a,a.a],data:function(){return{searchForm:new d,form:new u,rules:m,searchModel:d,model:u,tools:p.a,curd:{getInfo:l.getInfo||function(){},getInfoById:l.getInfoById||function(){},updateInfo:l.updateInfo||function(){},addInfo:l.addInfo||function(){},deleteInfoById:l.deleteInfoById||function(){},deleteAll:l.deleteAll||function(){}},types:["无"],templateFile:f.a.site+"/xls/config.xlsx",goods:[],editDialogFormVisible:!1,item:new c}},created:function(){var t=this;this.fetchData(),Object(s.getGoodsInfo)().then(function(e){t.goods=e.data})},filters:{filterCate:function(t,e){var n=e.find(function(e){return e.id===t});return n?n.name:"无"}},methods:{find:function(t){var e=this,n=document.querySelector(".el-input__inner");this.searchForm.sub_number=n.value,this.$nextTick().then(function(){e.fetchData()})},editHandle:function(t){var e=t.data;this.form={},this.form.sub_number=e.sub_number,this.form.id=e.id,this.form.remark=e.remark;var n=e.tips.split(","),o=e.good_ids.split(","),i=[];n.forEach(function(t,e){var n=t.split(/[\(\)×]/);n.splice(2,1);var a=r()(n,3),l=a[0],s=a[1],u=a[2];u=+u;var c={id:+o[e],number:l,name:s,count:u};i.push(c)}),this.form.result=i},addConfig:function(){if(!this.item.number)return this.$message.error("请选择商品后再添加配对"),!1;if(this.item.count){var t=this.item.number;t=t.trim();var e=this.goods.find(function(e){return e.number===t});if(void 0===e)return this.$message.error("指定的商品信息不存在，请重新填写"),this.item.number=null,this.item.count=null,!1;this.item.id=e.id,this.item.name=e.name;if(this.form.result.findIndex(function(e){return e.number===t})>=0)return this.$message.error("商品信息已经存在，请勿重复添加"),!1;this.form.result.push(this.item),this.item=new c}else this.$message.error("请输入数量后再添加配对")},delConfig:function(t){var e=this.form.result.findIndex(function(e){return e.number===t.number});this.form.result.splice(e,1)},fetchData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.searchForm,e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.current_page,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pageSize;this.loading=!0,this.curd.getInfo(t,n,o).then(function(t){var n=t.data,o=[];n.forEach(function(t){o=[];var e=t.tips.split(",");return e.forEach(function(t,e){var n=t.split(/[\(\)×]/);n.splice(2,1);var i=r()(n,3),a=i[0],l=i[1],s=i[2],u={number:a,name:l,count:s=+s};o.push(u)}),t.note=e,t.result=o,t}),e.tableData=n,e.total=t.meta.total,e.loading=!1}).catch(function(t){e.tools.error(e,t.response.data),e.loading=!1})}}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"config"}},[n("el-form",{staticClass:"demo-form-inline",attrs:{id:"toolbar",inline:!0,model:t.searchForm}},[n("el-form-item",{attrs:{label:"配对编号"}},[n("el-input",{attrs:{placeholder:"请输入编号"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.find(e)}},model:{value:t.searchForm.sub_number,callback:function(e){t.$set(t.searchForm,"sub_number",e)},expression:"searchForm.sub_number"}})],1),t._v(" "),n("el-form-item",{staticStyle:{display:"none"},attrs:{label:"商品编号"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchForm.good_number,expression:"searchForm.good_number"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.searchForm.good_number},on:{input:function(e){e.target.composing||t.$set(t.searchForm,"good_number",e.target.value)}}})]),t._v(" "),n("el-form-item",[n("el-button",{attrs:{plain:""},on:{click:function(e){t.find()}}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{type:"info",plain:""},on:{click:function(e){t.findReset()}}},[t._v("重置")])],1)],1),t._v(" "),n("div",{attrs:{id:"datagrid"}},[n("div",{staticClass:"toolbar"},[n("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(e){t.add()}}},[t._v("添加配对信息")]),t._v(" "),n("el-button",{attrs:{plain:"",icon:"el-icon-plus"},on:{click:function(e){t.upload()}}},[t._v("导入配对表")])],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableData,border:""},on:{"select-all":t.selectChange,"selection-change":t.selectChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{label:"配对号",prop:"sub_number",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{label:"配对详情",width:"450"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",t._l(e.row.note,function(e,o){return n("p",{key:o},[t._v(t._s(e))])}))]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"备注",prop:"remark",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{content:"编辑",placement:"right-end",effect:"light"}},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"cates.show",expression:"'cates.show'"}],attrs:{plain:"",icon:"el-icon-edit",type:"primary",size:"small"},on:{click:function(n){t.edit(e.row)}}})],1),t._v(" "),n("el-tooltip",{attrs:{content:"删除",placement:"right-end",effect:"light"}},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"cates.destory",expression:"'cates.destory'"}],attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(n){t.del(e.row)}}})],1)]}}])})],1),t._v(" "),n("el-row",{staticClass:"page"},[n("el-col",{attrs:{span:2,offset:1}},[n("el-button",{attrs:{type:"danger",plain:""},on:{click:function(e){t.delAll()}}},[t._v("删除选择")])],1),t._v(" "),n("el-col",{attrs:{span:20}},[n("el-pagination",{attrs:{background:"","current-page":t.current_page,"page-sizes":[10,20,25,50],layout:"total,sizes,prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.pagination,"size-change":t.sizeChange,"update:currentPage":function(e){t.current_page=e},"update:pageSize":function(e){t.pageSize=e}}})],1)],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"配对管理",center:"",visible:t.editDialogFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.editDialogFormVisible=e}}},[n("el-form",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"配对编号",prop:"sub_number"}},[n("el-input",{attrs:{disabled:!0===t.isEdit},model:{value:t.form.sub_number,callback:function(e){t.$set(t.form,"sub_number",e)},expression:"form.sub_number"}})],1)],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"备注",prop:"remark"}},[n("el-input",{model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1),t._v(" "),n("fieldset",[n("legend",[t._v("配对操作")]),t._v(" "),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-input",{model:{value:t.item.number,callback:function(e){t.$set(t.item,"number",e)},expression:"item.number"}})],1),t._v(" "),n("el-col",{attrs:{span:12}},[n("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[n("el-input-number",{attrs:{min:0},model:{value:t.item.count,callback:function(e){t.$set(t.item,"count",e)},expression:"item.count"}})],1),t._v(" "),n("el-col",{staticClass:"toolbar-config",staticStyle:{"text-align":"right"},attrs:{span:10}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"mini"},on:{click:t.addConfig}})],1)],1)],1)],1),t._v(" "),n("fieldset",[n("legend",[t._v("配对表")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.form.result,border:""}},[n("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),n("el-table-column",{attrs:{prop:"number",label:"商品编号",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"商品名称",width:"200"}}),t._v(" "),n("el-table-column",{attrs:{prop:"count",label:"数量",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{attrs:{content:"删除",placement:"right-end",effect:"light"}},[n("el-button",{directives:[{name:"has",rawName:"v-has",value:"cates.destory",expression:"'cates.destory'"}],attrs:{plain:"",icon:"el-icon-delete",type:"danger",size:"small"},on:{click:function(n){t.delConfig(e.row)}}})],1)]}}])})],1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.save()}}},[t._v("确 定")]),t._v(" "),n("el-button",{on:{click:function(e){t.cancel()}}},[t._v("取 消")])],1)],1),t._v(" "),n("upload-xls",{attrs:{show:t.isShowUpload,"template-file":t.templateFile,module:"config"},on:{"close-upload":t.closeUpload}})],1)},staticRenderFns:[]};var h=n("VU/8")(g,b,!1,function(t){n("eab/")},null,null);e.default=h.exports},d7EF:function(t,e,n){"use strict";e.__esModule=!0;var o=i(n("us/S")),r=i(n("BO1k"));function i(t){return t&&t.__esModule?t:{default:t}}e.default=function(){return function(t,e){if(Array.isArray(t))return t;if((0,o.default)(Object(t)))return function(t,e){var n=[],o=!0,i=!1,a=void 0;try{for(var l,s=(0,r.default)(t);!(o=(l=s.next()).done)&&(n.push(l.value),!e||n.length!==e);o=!0);}catch(t){i=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},"eab/":function(t,e,n){var o=n("tdF+");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);n("rjj0")("fd816920",o,!0)},fxRn:function(t,e,n){n("+tPU"),n("zQR9"),t.exports=n("g8Ux")},g8Ux:function(t,e,n){var o=n("77Pl"),r=n("3fs2");t.exports=n("FeBl").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return o(e.call(t))}},"tdF+":function(t,e,n){(t.exports=n("FZ+f")(!1)).push([t.i,"\n#toolbar {\n  background-color: #e8e8e8 !important;\n  margin-bottom: 5px;\n}\n#toolbar .el-form-item {\n    margin-bottom: 5px;\n    margin-top: 5px;\n    margin-left: 5px;\n}\n#datagrid {\n  border: 1px solid #ddd;\n  padding-bottom: 5px;\n}\n#datagrid .toolbar {\n    padding-left: 5px;\n    margin-bottom: 5px;\n    margin-top: 5px;\n}\n#datagrid .page {\n    margin-top: 5px;\n    height: 40px;\n}\n#datagrid .page .el-col-2 {\n      text-align: center;\n      min-width: 120px;\n      height: 100%;\n}\n#datagrid .page .el-col-20 {\n      line-height: 40px;\n      height: 100%;\n}\n#datagrid .page .el-col-20 .el-pagination {\n        padding: 0;\n        margin-top: 5px;\n        text-align: center;\n}\n#datagrid .toolbar {\n  margin-bottom: 10px;\n}\n#datagrid .page {\n  margin-top: 10px;\n}\n.toolbar-config .el-button--mini, .el-button--mini.is-round {\n  padding: 10px 10px;\n}\n.toolbar-config .el-button + .el-button {\n  margin-left: 5px;\n}\n",""])},"us/S":function(t,e,n){t.exports={default:n("Xd32"),__esModule:!0}}});